<!DOCTYPE html>
<html>
<head>
    <title>Direct URL Test</title>
</head>
<body>
    <h1>Test Google Apps Script with Direct URL</h1>
    
    <h3>Test 1: Simple GET request</h3>
    <button onclick="testGet()">Test GET Request</button>
    
    <h3>Test 2: Use form submission (no CORS)</h3>
    <form id="testForm" target="_blank" method="POST">
        <input type="hidden" name="formType" value="contact">
        <input type="hidden" name="name" value="Form Test User">
        <input type="hidden" name="email" value="formtest@example.com">
        <input type="hidden" name="message" value="Test via form submission">
        <button type="submit">Submit via Form (Opens new tab)</button>
    </form>
    
    <div id="result"></div>

    <script>
        // Replace with your Google Apps Script URL
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzZqV1oMPZ06edppgmZcpDbH9vXQpW1ModuVZxXaD5LEoeMVezYbJ_siGskyAm5EbJb/exec';
        
        function updateFormAction() {
            document.getElementById('testForm').action = SCRIPT_URL;
        }
        
        function testGet() {
            const testUrl = SCRIPT_URL + '?test=true&timestamp=' + Date.now();
            window.open(testUrl, '_blank');
        }
        
        // Update form action when page loads
        window.onload = function() {
            updateFormAction();
            document.getElementById('result').innerHTML = `
                <p><strong>Instructions:</strong></p>
                <ol>
                    <li>Update SCRIPT_URL variable with your Google Apps Script URL</li>
                    <li>Test GET request - should open new tab with JSON response</li>
                    <li>Test form submission - should submit data without CORS issues</li>
                    <li>Check your Google Sheets for new entries</li>
                </ol>
                <p><strong>Current URL:</strong> ${SCRIPT_URL}</p>
            `;
        };
    </script>
</body>
</html>